***********************************************************************
*eor* cthin
***********************************************************************
*
HEROTOCI_test 
*
control 
  mmp
  selfgravity
  tstop = 5e2
  ntbad = 100000000
  rdumpf 1000000
endc

*restart
* nu=3
*endr

spy

 PlotTime(0.0, 5e1);
 SaveTime(0.0, 5e1);
 Save("VOLM,DENS,P,T,VX,VY,VZ");

 ImageFormat(800,600);

 define main()
 {
   pprintf(" PLOT: Cycle=%d, Time=%e\n",CYCLE,TIME);
   
   Image("Density_1D_equi", WHITE, BLACK);
    Fix1D(0, 0, 0, 1e9, 0, 0);
    VLimits(1e-1, 3e1);
    Label(sprintf("Density along equitorial radius"));
    Plot1D("DENS", ON, OFF, "dens_equi");
   EndImage;

   Image("Pressure_1D_equi", WHITE, BLACK);
    Fix1D(0, 0, 0, 1e9, 0, 0);
    VLimits(1e4, 1e13, LOG_MAP);
    Label(sprintf("Pressure along equitorial radius"));
    Plot1D("P", ON, OFF, "P_equi");
   EndImage;

   Image("Temp_1D_equi", WHITE, BLACK);
    Fix1D(0, 0, 0, 1e9, 0, 0);
    VLimits(1e-2, 1e1, LOG_MAP);
    Label(sprintf("Temperature along equitorial radius"));
    Plot1D("T", ON, OFF, "T_equi");
   EndImage;

   Image("Density_1D_pole", WHITE, BLACK);
    Fix1D(0, 0, 0, 0, 0, 1e9);
    VLimits(1e-1, 3e1);
    Label(sprintf("Density along polar radius"));
    Plot1D("DENS", ON, OFF, "dens_pole");
   EndImage;

   Image("Pressure_1D_pole", WHITE, BLACK);
    Fix1D(0, 0, 0, 0, 0, 1e9);
    VLimits(1e4, 1e13, LOG_MAP);
    Label(sprintf("Pressure along polar radius"));
    Plot1D("P", ON, OFF, "P_pole");
   EndImage;

   Image("Temp_1D_pole", WHITE, BLACK);
    Fix1D(0, 0, 0, 0, 0, 1e9);
    VLimits(1e-2, 1e1, LOG_MAP);
    Label(sprintf("Temperature along polar radius"));
    Plot1D("T", ON, OFF, "T_pole");
   EndImage;

   Image("Pressure_surf",WHITE,BLACK);
    XLimits(-1e9, 1e9);
    YLimits(0, 1e9);
    ZLimits(-1e9, 0);
    RotateZ(30);
    RotateX(-60);
    HotMap2;
    Label(sprintf("Pressure at %0.2e secs.",TIME));
    ColorMapRange(1e6,1e15,LOG_MAP);
    ColorMapClipping(OFF,OFF);
    Paint3DMat(1,"P");
    Paint3DMat(2,"P");
    DrawColorMap("Pressure",0.85,0.6,0.99,0.99);
    HotMap1;
    ColorMapRange(-1e15,-1e6,LOG_MAP);
    ColorMapClipping(OFF,ON);
    Paint3DMat(1,"P");
    Paint3DMat(2,"P");
    Paint3DMat(3,"P");
    DrawColorMap("",0.85,0.2,0.99,0.59);
   EndImage;

   Image("Density",WHITE,BLACK);
    Fix(0, 0, 0, 0, 1, 0);
    XLimits(-1e9, 1e9);
    ZLimits(-1e9, 1e9);
    RotateX(-90);
    ColorMapRange(1e-1, 3e1);
    ColorMapClipping(ON, OFF);
    Label(sprintf("Density as %0.2e secs.", TIME));
    Plot2D("DENS");
    Draw2DBlockEdges;
    DrawColorMap("Density",0.85,0.45,1,0.95);
   EndImage;
 }

endspy

* AMR calculation
amr
 3dr
 debug
 nx = 8
 ny = 8
 nz = 8
 bx = 1
 by = 1
 bz = 1
 gmin =  -1e9,   -1e9,   -1e9
 gmax =   1e9,    1e9,    1e9 
 maxl = 4
 maxb = 2000

 * The combintion of these two indicators will keep
 * moving interfaces refined:

 indicator
  val vfmax
  p1 -1e9, -1e9, -1e9
  p2  1e9,  1e9,  1e9
  refabove 0
  refbelow 0.999999
  unrabove 0.999999
 endi

 indicator
  and
  p1 -1e9, -1e9, -1e9
  p2  1e9,  1e9,  1e9
  val vmag
  refabove 10
 endi

 * Resolve the shock wave using a pressure-difference
 * histogram

 indicator
  diff p
  logh
  vmin 1e8
  refabove 0.9
  unrbelow 0.5
 endi

enda 

convct
   convection = 1
   interface = smyra
endc
*
********************************************************************* 
*  TRACER RECORDS
*
tracer
   add  7e7 0 0
endt
*

edit
  shortt
    tim = 0.,  dt = 1.0
  ends
*
  longt
    tim = 0.,  dt = 1.0
  endl 

  restt
    tim = 0.
    dtf = 2e-6
  endr
*
*  plott 
*    tim = 0.,  dt = 1.0
*  endp
ende

*  spall parameters 
 fracts 
   stress
   pfrac1  -3.0e9
   pfrac2  -3.0e9
   pfmix   -1e8
   pfvoid  -3.0e9
 endf 
*
boundary
   bhy
       bxb = 1 , bxt = 2
       byb = 1 , byt = 0
       bzb = 1 , bzt = 2
   endh 
endb
mindt 
   time = 0.  dt = 1.e-12
endn
*
**********************************************************************
*
*  equation of state inputs
*
eos
* ------------------------
* Mantle
* ------------------------
   mat1 sesame mantle
* ------------------------
* Iron
* ------------------------
   mat2 sesame iron
*
endeos

*epdata

* matep 1
* steinberg 2024-T4_ALUMINUM
* poisson 0.3
* matep 2
* steinberg 2024-T4_ALUMINUM
* poisson 0.3
*endepdata

****************************************************************
* material insertion inputs
diatom
 assemblage 'HEROTOCI_test_6_L0_N3_Nm13_k6_f020_p10_l1_0_1.5'
  avelocity 0 0 0.0002
  package 'layer0'
   mat 1
   pressure 10000000.0
   temperature 0.162191774713
   insert r2dp
    ce1 0, 0, 0
    ce2 0, 0, 1
    ce3 1, 0, 0
    twist = 1
    pitch = 0, 0
    p1 = 0.0, -633884983.8200593
    p2 = 252893632.77825174, -580051644.2327445
    p3 = 349089381.035845, -526272043.26968443
    p4 = 419967542.18786854, -476198432.29205436
    p5 = 474311022.09974444, -424236675.1569734
    p6 = 518325007.7797258, -372253166.12845737
    p7 = 554100140.7916702, -319909865.4440803
    p8 = 582803356.7591637, -267127480.60206088
    p9 = 604834920.7030057, -213841436.9637615
    p10 = 621683340.218398, -160517948.21869698
    p11 = 633785162.8137686, -107129245.38717243
    p12 = 641449318.1982355, -53640686.716777034
    p13 = 643679258.2744483, -0.0
    p14 = 643679258.2744483, 0.0
    p15 = 641449318.1982355, 53640686.716777034
    p16 = 633785162.8137686, 107129245.38717243
    p17 = 621683340.218398, 160517948.21869698
    p18 = 604834920.7030057, 213841436.9637615
    p19 = 582803356.7591637, 267127480.60206088
    p20 = 554100140.7916702, 319909865.4440803
    p21 = 518325007.7797258, 372253166.12845737
    p22 = 474311022.09974444, 424236675.1569734
    p23 = 419967542.18786854, 476198432.29205436
    p24 = 349089381.035845, 526272043.26968443
    p25 = 252893632.77825174, 580051644.2327445
    p26 = 0.0, 633884983.8200593
    p27 = 0.0, 414615241.3413265
    p28 = 171037982.1292341, 392302730.8769986
    p29 = 237286679.94159424, 357723129.59791774
    p30 = 284474978.58930874, 322564306.1004578
    p31 = 321171846.46553487, 287264832.46242464
    p32 = 350692727.59225917, 251862202.7203477
    p33 = 374548094.825802, 216245443.37213826
    p34 = 393724139.71762484, 180463163.56143606
    p35 = 408748968.7331787, 144514583.79711935
    p36 = 420155342.5337127, 108483642.96354279
    p37 = 428149977.74818623, 72370555.07115985
    p38 = 432896721.7713007, 36200642.47395128
    p39 = 434483499.3352524, 0.0
    p40 = 434483499.3352524, -0.0
    p41 = 432896721.7713007, -36200642.47395128
    p42 = 428149977.74818623, -72370555.07115985
    p43 = 420155342.5337127, -108483642.96354279
    p44 = 408748968.7331787, -144514583.79711935
    p45 = 393724139.71762484, -180463163.56143606
    p46 = 374548094.825802, -216245443.37213826
    p47 = 350692727.59225917, -251862202.7203477
    p48 = 321171846.46553487, -287264832.46242464
    p49 = 284474978.58930874, -322564306.1004578
    p50 = 237286679.94159424, -357723129.59791774
    p51 = 171037982.1292341, -392302730.8769986
    p52 = 0.0, -414615241.3413265
   endi
  endpackage
  package 'layer1'
   mat 1
   pressure 812515285033.0664
   temperature 0.221273807139
   insert r2dp
    ce1 0, 0, 0
    ce2 0, 0, 1
    ce3 1, 0, 0
    twist = 1
    pitch = 0, 0
    p1 = 0.0, -414615241.3413265
    p2 = 171037982.1292341, -392302730.8769986
    p3 = 237286679.94159424, -357723129.59791774
    p4 = 284474978.58930874, -322564306.1004578
    p5 = 321171846.46553487, -287264832.46242464
    p6 = 350692727.59225917, -251862202.7203477
    p7 = 374548094.825802, -216245443.37213826
    p8 = 393724139.71762484, -180463163.56143606
    p9 = 408748968.7331787, -144514583.79711935
    p10 = 420155342.5337127, -108483642.96354279
    p11 = 428149977.74818623, -72370555.07115985
    p12 = 432896721.7713007, -36200642.47395128
    p13 = 434483499.3352524, -0.0
    p14 = 434483499.3352524, 0.0
    p15 = 432896721.7713007, 36200642.47395128
    p16 = 428149977.74818623, 72370555.07115985
    p17 = 420155342.5337127, 108483642.96354279
    p18 = 408748968.7331787, 144514583.79711935
    p19 = 393724139.71762484, 180463163.56143606
    p20 = 374548094.825802, 216245443.37213826
    p21 = 350692727.59225917, 251862202.7203477
    p22 = 321171846.46553487, 287264832.46242464
    p23 = 284474978.58930874, 322564306.1004578
    p24 = 237286679.94159424, 357723129.59791774
    p25 = 171037982.1292341, 392302730.8769986
    p26 = 0.0, 414615241.3413265
    p27 = 0.0, 328650881.7155387
    p28 = 131170263.80434631, 300859797.68762726
    p29 = 181054594.41625693, 272950071.02213645
    p30 = 217281484.1988761, 246374045.00967282
    p31 = 245311658.0899129, 219413417.26489258
    p32 = 267855688.23341155, 192369896.32724524
    p33 = 286189737.9675525, 165231722.25487486
    p34 = 300777297.9605954, 137861048.49034214
    p35 = 312105224.53334665, 110345860.35563971
    p36 = 320693207.6666742, 82802630.16899106
    p37 = 326812257.9799352, 55241354.06583516
    p38 = 330494047.7455773, 27637300.67821409
    p39 = 331763376.0838689, 0.0
    p40 = 331763376.0838689, -0.0
    p41 = 330494047.7455773, -27637300.67821409
    p42 = 326812257.9799352, -55241354.06583516
    p43 = 320693207.6666742, -82802630.16899106
    p44 = 312105224.53334665, -110345860.35563971
    p45 = 300777297.9605954, -137861048.49034214
    p46 = 286189737.9675525, -165231722.25487486
    p47 = 267855688.23341155, -192369896.32724524
    p48 = 245311658.0899129, -219413417.26489258
    p49 = 217281484.1988761, -246374045.00967282
    p50 = 181054594.41625693, -272950071.02213645
    p51 = 131170263.80434631, -300859797.68762726
    p52 = 0.0, -328650881.7155387
   endi
  endpackage
  package 'layer2'
   mat 2
   pressure 1382571014188.7063
   temperature 0.32840493687
   insert r2dp
    ce1 0, 0, 0
    ce2 0, 0, 1
    ce3 1, 0, 0
    twist = 1
    pitch = 0, 0
    p1 = 0.0, -328650881.7155387
    p2 = 131170263.80434631, -300859797.68762726
    p3 = 181054594.41625693, -272950071.02213645
    p4 = 217281484.1988761, -246374045.00967282
    p5 = 245311658.0899129, -219413417.26489258
    p6 = 267855688.23341155, -192369896.32724524
    p7 = 286189737.9675525, -165231722.25487486
    p8 = 300777297.9605954, -137861048.49034214
    p9 = 312105224.53334665, -110345860.35563971
    p10 = 320693207.6666742, -82802630.16899106
    p11 = 326812257.9799352, -55241354.06583516
    p12 = 330494047.7455773, -27637300.67821409
    p13 = 331763376.0838689, -0.0
    p14 = 331763376.0838689, 0.0
    p15 = 330494047.7455773, 27637300.67821409
    p16 = 326812257.9799352, 55241354.06583516
    p17 = 320693207.6666742, 82802630.16899106
    p18 = 312105224.53334665, 110345860.35563971
    p19 = 300777297.9605954, 137861048.49034214
    p20 = 286189737.9675525, 165231722.25487486
    p21 = 267855688.23341155, 192369896.32724524
    p22 = 245311658.0899129, 219413417.26489258
    p23 = 217281484.1988761, 246374045.00967282
    p24 = 181054594.41625693, 272950071.02213645
    p25 = 131170263.80434631, 300859797.68762726
    p26 = 0.0, 328650881.7155387
    p27 = 0.0, 0.0
    p28 = 0.0, -0.0
   endi
  endpackage
 endassemblage
enddiatom


*************************************************************
